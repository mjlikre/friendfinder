<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>survey</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet"
    href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet"
        href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

    <!-- <script src="main.js"></script> -->
</head>
<body>
    <h1>survey</h1>
    <form>
        <div class="form-group">
            <label for="name">Enter Your Name </label>
            <input type="text" class="form-control" id="name" placeholder="John Doe">
        </div>
        <div class="form-group">
            <label for="img">Submit your image link</label>
            <input type="text" class="form-control" id="image" placeholder="img">
        </div>

        <div class="form-group">
            <label for="question">Do you like to read?</label>
            <select class="form-control" id="qestion0">
                    <option></option>
                    <option value = '1'>1 (Not at all)</option>
                    <option value = '2'>2</option>
                    <option value = '3'>3</option>
                    <option value = '4'>4</option>
                    <option value = '5'>5 (YESS)</option>
            </select>
        </div>
        <div class="form-group">
            <label for="question">Do you like to cook?</label>
            <select class="form-control" id="qestion1">
                    <option value = ''></option>
                    <option value = '1'>1 (Not at all)</option>
                    <option value = '2'>2</option>
                    <option value = '3'>3</option>
                    <option value = '4'>4</option>
                    <option value = '5'>5 (YESS)</option>
            </select>
        </div>
        <div class="form-group">
            <label for="question">What do you prefer, cats or dogs?</label>
            <select class="form-control" id="qestion2">
                    <option value = ''></option>
                <option value = '1'>Dogs</option>
                <option value = '2'>Cats</option>
            
            </select>
        </div>
        <div class="form-group">
            <label for="question">Do you enjoy music?</label>
            <select class="form-control" id="qestion3">
                    <option value = ''></option>
                    <option value = '1'>1 (Not at all)</option>
                    <option value = '2'>2</option>
                    <option value = '3'>3</option>
                    <option value = '4'>4</option>
                    <option value = '5'>5 (YESS)</option>
            </select>
        </div>
        <div class="form-group">
            <label for="question">Do you like boba?</label>
            <select class="form-control" id="qestion4">
                    <option value = ''></option>
                    <option value = '1'>1 (Not at all)</option>
                    <option value = '2'>2</option>
                    <option value = '3'>3</option>
                    <option value = '4'>4</option>
                    <option value = '5'>5 (YESS)</option>
            </select>
        </div>
        <div class="form-group">
            <label for="question">Are you a religious</label>
            <select class="form-control" id="qestion5">
                    <option value = ''></option>
                    <option value = '1'>1 (Not at all)</option>
                    <option value = '2'>2</option>
                    <option value = '3'>3</option>
                    <option value = '4'>4</option>
                    <option value = '5'>5 (YESS)</option>
            </select>
        </div>
        <div class="form-group">
            <label for="question">Do you like to exercise?</label>
            <select class="form-control" id="qestion6">
                    <option value = ''></option>
                    <option value = '1'>1 (Not at all)</option>
                    <option value = '2'>2</option>
                    <option value = '3'>3</option>
                    <option value = '4'>4</option>
                    <option value = '5'>5 (YESS)</option>
            </select>
        </div>
        <div class="form-group">
            <label for="question">Do you like movies?</label>
            <select class="form-control" id="qestion7">
                <option value = ''></option>
                <option value = '1'>1 (Not at all)</option>
                <option value = '2'>2</option>
                <option value = '3'>3</option>
                <option value = '4'>4</option>
                <option value = '5'>5 (YESS)</option>
            </select>
        </div>
        <div class="form-group">
            <label for="question">How strong is your believe in unicorns?</label>
            <select class="form-control" id="qestion8">
                    <option value = ''></option>
                    <option value = '1'>1 (Not at all)</option>
                    <option value = '2'>2</option>
                    <option value = '3'>3</option>
                    <option value = '4'>4</option>
                    <option value = '5'>5 (YESS)</option>
            </select>
        </div>
        <div class="form-group">
            <label for="question">Do you like Rick and Morty?</label>
            <select class="form-control" id="qestion9">
                    <option value = ''></option>
                    <option value = '1'>1 (Not at all)</option>
                    <option value = '2'>2</option>
                    <option value = '3'>3</option>
                    <option value = '4'>4</option>
                    <option value = '5'>5 (YESS)</option>
            </select>
        </div>
        <div class = 'popup'>
            <button type= 'submit' class = 'btn btn-primary' id = 'submit'>Submit</button>


        </div>
    </form>


    <script type="text/javascript">
        $(document).ready(function(){
            
            $('#submit').on('click', function(event){
                event.preventDefault();
                const newFriend = {
                    name : $('#name').val().trim(),
                    photo : $('#image').val().trim(),
                    scores: [
                        $('#qestion0').val(),
                        $('#qestion1').val(),
                        $('#qestion2').val(),
                        $('#qestion3').val(),
                        $('#qestion4').val(),
                        $('#qestion5').val(),
                        $('#qestion6').val(),
                        $('#qestion7').val(),
                        $('#qestion8').val(),
                        $('#qestion9').val()

                    ]
                }
                var checker = 0; 
                var matched=[];
                const scores = newFriend.scores;
                for(var i = 0; i < scores.length; i ++){
                    if(newFriend.name === ''){
                        checker ++;
                    } 
                    else if(newFriend.scores[i] === ''){
                        checker ++;
                    }
                    
                }
                const posting = function(){
                    $.post('/api/friends', newFriend, () => {
                     
                    });
                }

                if (checker === 0){
                    $.get('/api/friends', data =>{
                        console.log(data);
                        for (var i = 0; i < data.length; i ++){
                            var matching = 0;
                            for(var j = 0; j < 10; j ++){
                                if(data[i].scores[j] === scores[j]){
                                    matching ++;
                                }
                            } 
                            
                            matched[i] = matching;
                        }
                    })
                   
                    console.log(arr)
                    console.log(typeof [1]);
                    var friendIndex = arr.indexOf(Math.max(arr));
                    
                    console.log(friendIndex);
                    posting();

                }
                else{
                    alert("Please don't leave any fields blank!")
                }

                
   
            })
   
        });
  
    </script>
</body>

</html>